#!/usr/bin/env node

var minimist = require('minimist');
var options = minimist(process.argv, {
  boolean: [
    'no-color',
    'json',
    'dry-run',
    'ignore-stars',
    'ignore-pegged'
  ],
  alias: {
    'dry-run': 'n'
  },
  default: {
    'no-color': false,
    json: false,
    'dry-run': false,
    'ignore-stars': false,
    'ignore-pegged': false
  }
});
var salita = require('../');

salita(process.cwd(), options, function (counts) {
  counts.then(function (counts) {
    var sums = counts.reduce(function (sums, category) { return [sums[0] + category[0], sums[1] + category[1]]; }, [0, 0]);
    var total = sums[0];
    var changed = sums[1];
    if (!options.json) {
      console.log('\n' + changed + ' updated out of ' + total + ' total dependencies.' + '\n');
      console.log(options['dry-run'] ? 'Completed upgrade report.' : 'Completed upgrade.');
    }
  });
});
